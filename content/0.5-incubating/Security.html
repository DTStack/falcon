<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-03-11
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160311" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Falcon - Securing Falcon</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                        
                    
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://falcon.incubator.apache.org/index.html" id="bannerLeft">
                                                                                                <img src="images/falcon-logo.png"  alt="Falcon" width="200px" height="45px"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://incubator.apache.org" id="bannerRight">
                                                                                                <img src="images/apache-incubator-logo.png"  alt="Apache Incubator"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="index.html" title="Home">
        Home</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Securing Falcon</li>
        
                
                    
      
                                              
    <li class="pull-right">              <a href="http://s.apache.org/falcon-0.5-release-notes" class="externalLink" title="Released: 2014-09-22">
        Released: 2014-09-22</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://archive.apache.org/dist/incubator/falcon/" class="externalLink" title="0.5-incubating">
        0.5-incubating</a>
  </li>

                        </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <div class="section">
<h2>Securing Falcon<a name="Securing_Falcon"></a></h2></div>
<div class="section">
<h3>Overview<a name="Overview"></a></h3>
<p>Apache Falcon enforces authentication on protected resources. Once authentication has been established it sets a signed HTTP Cookie that contains an authentication token with the user name, user principal, authentication type and expiration time.</p>
<p>It does so by using <a class="externalLink" href="./Http://hadoop.apache.org/docs/current/hadoop-auth/index.html.html">Hadoop Auth</a>. Hadoop Auth is a Java library consisting of a client and a server components to enable Kerberos SPNEGO authentication for HTTP. Hadoop Auth also supports additional authentication mechanisms on the client and the server side via 2 simple interfaces.</p></div>
<div class="section">
<h3>Authentication Methods<a name="Authentication_Methods"></a></h3>
<p>It supports 2 authentication methods, simple and kerberos out of the box.</p></div>
<div class="section">
<h4>Pseudo/Simple Authentication<a name="PseudoSimple_Authentication"></a></h4>
<p>Falcon authenticates the user by simply trusting the value of the query string parameter 'user.name'. This is the default mode Falcon is configured with.</p></div>
<div class="section">
<h4>Kerberos Authentication<a name="Kerberos_Authentication"></a></h4>
<p>Falcon uses HTTP Kerberos SPNEGO to authenticate the user.</p></div>
<div class="section">
<h3>Server Side Configuration Setup<a name="Server_Side_Configuration_Setup"></a></h3></div>
<div class="section">
<h4>Common Configuration Parameters<a name="Common_Configuration_Parameters"></a></h4>
<div class="source">
<pre>
# Authentication type must be specified: simple|kerberos
*.falcon.authentication.type=kerberos

</pre></div></div>
<div class="section">
<h4>Kerberos Configuration<a name="Kerberos_Configuration"></a></h4>
<div class="source">
<pre>
##### Service Configuration

# Indicates the Kerberos principal to be used in Falcon Service.
*.falcon.service.authentication.kerberos.principal=falcon/_HOST@EXAMPLE.COM

# Location of the keytab file with the credentials for the Service principal.
*.falcon.service.authentication.kerberos.keytab=/etc/security/keytabs/falcon.service.keytab

# name node principal to talk to config store
*.dfs.namenode.kerberos.principal=nn/_HOST@EXAMPLE.COM

##### SPNEGO Configuration

# Authentication type must be specified: simple|kerberos|&lt;class&gt;
# org.apache.falcon.security.RemoteUserInHeaderBasedAuthenticationHandler can be used for backwards compatibility
*.falcon.http.authentication.type=kerberos

# Indicates how long (in seconds) an authentication token is valid before it has to be renewed.
*.falcon.http.authentication.token.validity=36000

# The signature secret for signing the authentication tokens.
*.falcon.http.authentication.signature.secret=falcon

# The domain to use for the HTTP cookie that stores the authentication token.
*.falcon.http.authentication.cookie.domain=

# Indicates if anonymous requests are allowed when using 'simple' authentication.
*.falcon.http.authentication.simple.anonymous.allowed=true

# Indicates the Kerberos principal to be used for HTTP endpoint.
# The principal MUST start with 'HTTP/' as per Kerberos HTTP SPNEGO specification.
*.falcon.http.authentication.kerberos.principal=HTTP/_HOST@EXAMPLE.COM

# Location of the keytab file with the credentials for the HTTP principal.
*.falcon.http.authentication.kerberos.keytab=/etc/security/keytabs/spnego.service.keytab

# The kerberos names rules is to resolve kerberos principal names, refer to Hadoop's KerberosName for more details.
*.falcon.http.authentication.kerberos.name.rules=DEFAULT

# Comma separated list of black listed users
*.falcon.http.authentication.blacklisted.users=

</pre></div></div>
<div class="section">
<h4>Pseudo/Simple Configuration<a name="PseudoSimple_Configuration"></a></h4>
<div class="source">
<pre>
##### SPNEGO Configuration

# Authentication type must be specified: simple|kerberos|&lt;class&gt;
# org.apache.falcon.security.RemoteUserInHeaderBasedAuthenticationHandler can be used for backwards compatibility
*.falcon.http.authentication.type=simple

# Indicates how long (in seconds) an authentication token is valid before it has to be renewed.
*.falcon.http.authentication.token.validity=36000

# The signature secret for signing the authentication tokens.
*.falcon.http.authentication.signature.secret=falcon

# The domain to use for the HTTP cookie that stores the authentication token.
*.falcon.http.authentication.cookie.domain=

# Indicates if anonymous requests are allowed when using 'simple' authentication.
*.falcon.http.authentication.simple.anonymous.allowed=true

# Comma separated list of black listed users
*.falcon.http.authentication.blacklisted.users=

</pre></div></div>
<div class="section">
<h4>SSL Configuration<a name="SSL_Configuration"></a></h4>
<div class="source">
<pre>
*.falcon.enableTLS=true
*.keystore.file=/path/to/keystore/file
*.keystore.password=password

</pre></div></div>
<div class="section">
<h4>Distributed Falcon Setup<a name="Distributed_Falcon_Setup"></a></h4>
<p>Falcon should be configured to communicate with Prism over TLS in secure mode. Its not enabled by default.</p></div>
<div class="section">
<h3>Changes to ownership and permissions of directories managed by Falcon<a name="Changes_to_ownership_and_permissions_of_directories_managed_by_Falcon"></a></h3>
<p></p>
<table border="0" class="table table-striped">
<tr class="a">
<th>Directory</th>
<th>Location</th>
<th>Owner</th>
<th>Permissions</th></tr>
<tr class="b">
<td>Configuration Store</td>
<td>${config.store.uri}</td>
<td>falcon</td>
<td>750</td></tr>
<tr class="a">
<td>Oozie coord/bundle XMLs</td>
<td>${cluster.staging-location}/workflows/{entity}/{entity-name}</td>
<td>falcon</td>
<td>644</td></tr>
<tr class="b">
<td>Shared libs</td>
<td>{cluster.working}/{lib,libext}</td>
<td>falcon</td>
<td>755</td></tr>
<tr class="a">
<td>App logs</td>
<td>${cluster.staging-location}/workflows/{entity}/{entity-name}/logs</td>
<td>falcon</td>
<td>777</td></tr></table></div>
<div class="section">
<h3>Backwards compatibility<a name="Backwards_compatibility"></a></h3></div>
<div class="section">
<h4>Scheduled Entities<a name="Scheduled_Entities"></a></h4>
<p>Entities already scheduled with an earlier version of Falcon are not compatible with this version</p></div>
<div class="section">
<h4>Falcon Clients<a name="Falcon_Clients"></a></h4>
<p>Older Falcon clients are backwards compatible wrt Authentication and user information sent as part of the HTTP header, Remote-User is still honoured when the authentication type is configured as below:</p>
<div class="source">
<pre>
*.falcon.http.authentication.type=org.apache.falcon.security.RemoteUserInHeaderBasedAuthenticationHandler

</pre></div></div>
<div class="section">
<h4>Blacklisted super users for authentication<a name="Blacklisted_super_users_for_authentication"></a></h4>
<p>The blacklist users used to have the following super users: hdfs, mapreduce, oozie, and falcon. The list is externalized from code into Startup.properties file and is empty now and needs to be configured specifically in the file.</p></div>
<div class="section">
<h4>Falcon Dashboard<a name="Falcon_Dashboard"></a></h4>
<p>The dashboard assumes an anonymous user in Pseudo/Simple method and hence anonymous users must be enabled for it to work.</p>
<div class="source">
<pre>
# Indicates if anonymous requests are allowed when using 'simple' authentication.
*.falcon.http.authentication.simple.anonymous.allowed=true

</pre></div>
<p>In Kerberos method, the browser must support HTTP Kerberos SPNEGO.</p></div>
<div class="section">
<h3>Known Limitations<a name="Known_Limitations"></a></h3>
<p></p>
<ul>
<li>ActiveMQ topics are not secure but will be in the near future</li>
<li>Entities already scheduled with an earlier version of Falcon are not compatible with this version as new</li></ul>workflow parameters are being passed back into Falcon such as the user are required
<ul>
<li>Use of hftp as the scheme for read only interface in cluster entity <a class="externalLink" href="https://issues.apache.org/jira/browse/HADOOP-10215">will not work in Oozie</a></li></ul>The alternative is to use webhdfs scheme instead and its been tested with <a href="./DistCp.html">DistCp</a>.</div>
<div class="section">
<h3>Examples<a name="Examples"></a></h3></div>
<div class="section">
<h4>Accessing the server using Falcon CLI (Java client)<a name="Accessing_the_server_using_Falcon_CLI_Java_client"></a></h4>
<p>There is no change in the way the CLI is used. The CLI has been changed to work with the configured authentication method.</p></div>
<div class="section">
<h4>Accessing the server using curl<a name="Accessing_the_server_using_curl"></a></h4>
<p>Try accessing protected resources using curl. The protected resources are:</p>
<div class="source">
<pre>
$ kinit
Please enter the password for venkatesh@LOCALHOST:

$ curl http://localhost:15000/api/admin/version

$ curl http://localhost:15000/api/admin/version?user.name=venkatesh

$ curl --negotiate -u foo -b ~/cookiejar.txt -c ~/cookiejar.txt curl http://localhost:15000/api/admin/version

</pre></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
              <div class="row span12">Copyright &copy;                    2013-2016
                        <a href="http://www.apache.org">Apache Software Foundation</a>.
            All Rights Reserved.      
                    
      </div>

                          
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
  </body>
</html>
